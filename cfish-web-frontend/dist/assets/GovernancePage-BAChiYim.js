import{u as P,e as $,d as S,r as o,j as e,f}from"./index-C8wrHQVv.js";import{M as C}from"./Modal-B5K59-TF.js";const O=()=>{const{t}=P(),{addNotification:c}=$(),{isConnected:b,publicKey:v}=S(),[g,d]=o.useState(!0),[h,u]=o.useState([]),[r,m]=o.useState("active"),[y,x]=o.useState(!1),[n,j]=o.useState(null),[l,i]=o.useState("");o.useEffect(()=>{(async()=>{d(!0);try{const a=await fetch(`https://api.example.com/governance/proposals?status=${r}`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const p=await a.json();u(p)}catch(a){console.error("Failed to fetch proposals:",a),c({type:"error",title:t("error"),message:t("Failed to load governance proposals")})}finally{d(!1)}})()},[r,c,t]);const N=async()=>{if(!l){c({type:"warning",title:t("No Option Selected"),message:t("Please select a vote option")});return}d(!0);try{const s=await fetch(`https://api.example.com/governance/proposals/${n.id}/vote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({walletAddress:v.toBase58(),option:l})});if(!s.ok){const k=await s.json();throw new Error(k.message||`HTTP error! status: ${s.status}`)}c({type:"success",title:t("success"),message:`${t("Vote cast successfully for proposal")} ${n.title}!`}),x(!1),i("");const a=await fetch(`https://api.example.com/governance/proposals?status=${r}`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const p=await a.json();u(p)}catch{c({type:"error",title:t("error"),message:t("Voting failed. Please try again.")})}finally{d(!1)}},w=s=>{j(s),i(""),x(!0)};return b?e.jsxs("div",{className:"min-h-screen bg-black text-white",children:[e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-6",children:t("governance.title")}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"bg-card p-1 rounded-lg flex space-x-1",children:[e.jsx("button",{onClick:()=>m("active"),className:`py-2 px-4 rounded-md text-sm font-medium ${r==="active"?"bg-primary text-black":"text-gray-400 hover:text-white"}`,children:t("governance.activeProposals")}),e.jsx("button",{onClick:()=>m("passed"),className:`py-2 px-4 rounded-md text-sm font-medium ${r==="passed"?"bg-primary text-black":"text-gray-400 hover:text-white"}`,children:t("governance.passedProposals")}),e.jsx("button",{onClick:()=>m("failed"),className:`py-2 px-4 rounded-md text-sm font-medium ${r==="failed"?"bg-primary text-black":"text-gray-400 hover:text-white"}`,children:t("governance.failedProposals")})]})}),g?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(f,{size:"lg"})}):h.length>0?e.jsx("div",{className:"space-y-6",children:h.map(s=>e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:s.title}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:s.description}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-400 mb-4",children:[e.jsxs("span",{children:[t("governance.proposer"),": ",s.proposer]}),e.jsxs("span",{children:[t("governance.endsIn"),": ",new Date(s.endDate).toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center mb-4",children:[e.jsxs("div",{className:"p-2 bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:t("governance.for")}),e.jsx("p",{className:"font-bold text-green-400",children:s.votesFor})]}),e.jsxs("div",{className:"p-2 bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:t("governance.against")}),e.jsx("p",{className:"font-bold text-red-400",children:s.votesAgainst})]}),e.jsxs("div",{className:"p-2 bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:t("governance.abstain")}),e.jsx("p",{className:"font-bold text-yellow-400",children:s.votesAbstain})]})]}),r==="active"&&e.jsx("button",{onClick:()=>w(s),className:"w-full px-4 py-2 bg-primary text-black rounded-lg hover:bg-primary/80 transition-colors",children:t("governance.vote")})]},s.id))}):e.jsx("div",{className:"text-center text-muted-foreground py-12",children:e.jsx("p",{children:t("governance.noProposalsFound")})})]}),e.jsx(C,{isOpen:y,onClose:()=>x(!1),title:t("governance.voteOnProposal")+": "+((n==null?void 0:n.title)||""),children:n&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:n.description}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t("governance.yourVote")}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>i("for"),className:`flex-1 px-4 py-2 rounded-lg ${l==="for"?"bg-green-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:t("governance.for")}),e.jsx("button",{onClick:()=>i("against"),className:`flex-1 px-4 py-2 rounded-lg ${l==="against"?"bg-red-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:t("governance.against")}),e.jsx("button",{onClick:()=>i("abstain"),className:`flex-1 px-4 py-2 rounded-lg ${l==="abstain"?"bg-yellow-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:t("governance.abstain")})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 text-gray-400 hover:text-white",children:t("cancel")}),e.jsx("button",{onClick:N,disabled:g||!l,className:"px-4 py-2 bg-primary text-black rounded-lg hover:bg-primary/80 disabled:opacity-50",children:g?e.jsx(f,{size:"sm"}):t("governance.submitVote")})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:t("wallet.connectYourWallet")}),e.jsx("p",{className:"text-gray-400 mb-6",children:t("wallet.connectToViewGovernance")})]})})};export{O as default};
