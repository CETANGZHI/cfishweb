import{u as C,e as T,d as F,r as m,j as e,f as P,R as S,M as B}from"./index-C8wrHQVv.js";import{U as p}from"./UserAvatar-CPB5Wdsn.js";import{N as f}from"./NFTCard-BNEZSIRD.js";import{U as $}from"./user-plus-B9WAvI4U.js";import{H as E}from"./heart-DstOrYv-.js";import{S as H}from"./send-BDycW8EI.js";const W=()=>{const{t}=C(),{addNotification:o}=T(),{isConnected:i,publicKey:c}=F(),[j,u]=m.useState(!0),[h,x]=m.useState([]),[g,y]=m.useState({});m.useEffect(()=>{(async()=>{u(!0);try{const r=await fetch("https://api.example.com/social/feed");if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const a=await r.json();x(a)}catch(r){console.error("Failed to fetch social feed:",r),o({type:"error",title:t("error"),message:t("Failed to load social feed")})}finally{u(!1)}})()},[o,t]);const b=async s=>{if(!i){o({type:"warning",title:t("connectWallet"),message:t("Please connect your wallet to like posts")});return}try{const r=await fetch(`https://api.example.com/social/feed/${s}/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:c.toBase58()})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);x(a=>a.map(n=>n.id===s?{...n,likes:n.likes+1,likedByMe:!n.likedByMe}:n)),o({type:"success",title:t("success"),message:t("Post liked successfully!")})}catch(r){console.error("Failed to like post:",r),o({type:"error",title:t("error"),message:t("Failed to like post. Please try again.")})}},N=(s,r)=>{y(a=>({...a,[s]:r}))},w=async s=>{if(!i){o({type:"warning",title:t("connectWallet"),message:t("Please connect your wallet to comment")});return}const r=g[s];if(!r||r.trim()===""){o({type:"warning",title:t("Invalid Comment"),message:t("Comment cannot be empty")});return}try{const a=await fetch(`https://api.example.com/social/feed/${s}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:c.toBase58(),comment:r})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();x(l=>l.map(d=>d.id===s?{...d,comments:[...d.comments,n]}:d)),y(l=>({...l,[s]:""})),o({type:"success",title:t("success"),message:t("Comment submitted successfully!")})}catch(a){console.error("Failed to submit comment:",a),o({type:"error",title:t("error"),message:t("Failed to submit comment. Please try again.")})}},k=async s=>{if(!i){o({type:"warning",title:t("connectWallet"),message:t("Please connect your wallet to follow users")});return}try{const r=await fetch("https://api.example.com/social/follow",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({followerId:c.toBase58(),followingId:s})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);o({type:"success",title:t("success"),message:t("User followed successfully!")})}catch(r){console.error("Failed to follow user:",r),o({type:"error",title:t("error"),message:t("Failed to follow user. Please try again.")})}},v=s=>{var n;const r=s.likedByMe,a=g[s.id]||"";return e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(p,{address:s.user.address,size:"md"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-foreground",children:s.user.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(s.timestamp).toLocaleString()})]}),i&&(c==null?void 0:c.toBase58())!==s.user.address&&e.jsxs("button",{onClick:()=>k(s.user.address),className:"flex items-center space-x-1 px-3 py-1 bg-primary text-black rounded-full text-sm hover:bg-primary/80 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:t("follow")})]})]}),s.type==="new_nft"&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-muted-foreground mb-3",children:[e.jsx("span",{className:"font-bold text-foreground",children:s.user.name})," ",t("social.createdNewNFT")]}),e.jsx(f,{nft:s.nft})]}),s.type==="purchase"&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-muted-foreground mb-3",children:[e.jsx("span",{className:"font-bold text-foreground",children:s.buyer.name})," ",t("social.purchasedNFT"),e.jsxs("span",{className:"font-bold text-foreground",children:[" ",s.nft.name]})," ",t("social.from"),e.jsxs("span",{className:"font-bold text-foreground",children:[" ",s.seller.name]})]}),e.jsx(f,{nft:s.nft})]}),s.type==="listing"&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-muted-foreground mb-3",children:[e.jsx("span",{className:"font-bold text-foreground",children:s.user.name})," ",t("social.listedNFT"),e.jsxs("span",{className:"font-bold text-foreground",children:[" ",s.nft.name]})," ",t("social.for"),e.jsxs("span",{className:"font-bold text-primary",children:[" ",s.price," ",s.currency.toUpperCase()]})]}),e.jsx(f,{nft:s.nft})]}),e.jsxs("div",{className:"flex items-center space-x-4 border-t border-border pt-4",children:[e.jsxs("button",{onClick:()=>b(s.id),className:`flex items-center space-x-1 text-sm ${r?"text-red-500":"text-gray-400 hover:text-red-400"}`,children:[e.jsx(E,{className:`w-5 h-5 ${r?"fill-current":""}`}),e.jsxs("span",{children:[s.likes," ",t("like")]})]}),e.jsxs("button",{className:"flex items-center space-x-1 text-sm text-gray-400 hover:text-primary",children:[e.jsx(B,{className:"w-5 h-5"}),e.jsxs("span",{children:[((n=s.comments)==null?void 0:n.length)||0," ",t("comment")]})]})]}),s.comments&&s.comments.length>0&&e.jsx("div",{className:"space-y-3 pl-4 border-l border-border",children:s.comments.map((l,d)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(p,{address:l.user.address,size:"sm"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground text-sm",children:l.user.name}),e.jsx("p",{className:"text-muted-foreground text-sm",children:l.text}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(l.timestamp).toLocaleString()})]})]},d))}),i&&e.jsxs("div",{className:"flex items-center space-x-3 pt-4 border-t border-border",children:[e.jsx(p,{address:c==null?void 0:c.toBase58(),size:"sm"}),e.jsx("input",{type:"text",placeholder:t("writeAComment"),value:a,onChange:l=>N(s.id,l.target.value),className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-primary"}),e.jsx("button",{onClick:()=>w(s.id),className:"p-2 bg-primary text-black rounded-lg hover:bg-primary/80 transition-colors",disabled:!a.trim(),children:e.jsx(H,{className:"w-5 h-5"})})]})]})};return e.jsx("div",{className:"min-h-screen bg-black text-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-6",children:t("social.title")}),j?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(P,{size:"lg"})}):h.length>0?e.jsx("div",{className:"space-y-6",children:h.map(s=>e.jsx(S.Fragment,{children:v(s)},s.id))}):e.jsx("div",{className:"text-center text-muted-foreground py-12",children:e.jsx("p",{children:t("social.noFeedItems")})})]})})};export{W as default};
