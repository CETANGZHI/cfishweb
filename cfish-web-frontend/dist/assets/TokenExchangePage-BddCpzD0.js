import{u as B,e as A,d as R,r as l,j as e,f as F}from"./index-C8wrHQVv.js";const k=()=>{const{t:s}=B(),{addNotification:c}=A(),{isConnected:m,publicKey:d}=R(),[f,h]=l.useState(!0),[u,w]=l.useState(0),[g,N]=l.useState(0),[x,C]=l.useState(0),[t,p]=l.useState(""),[a,b]=l.useState(""),[r,S]=l.useState("solToCfish");l.useEffect(()=>{m&&d&&(async()=>{h(!0);try{const n=await(await fetch(`https://api.example.com/wallet/${d.toBase58()}/sol-balance`)).json();w(n.balance);const j=await(await fetch(`https://api.example.com/wallet/${d.toBase58()}/cfish-balance`)).json();N(j.balance);const E=await(await fetch("https://api.example.com/exchange/rate")).json();C(E.cfishPerSol)}catch(i){console.error("Failed to fetch exchange data:",i),c({type:"error",title:s("error"),message:s("Failed to load exchange data")})}finally{h(!1)}})()},[m,d,c,s]),l.useEffect(()=>{r==="solToCfish"&&t?b((parseFloat(t)*x).toFixed(6)):r==="cfishToSol"&&a&&p((parseFloat(a)/x).toFixed(6))},[t,a,x,r]);const v=(o,i)=>{const n=o.target.value;i==="sol"?(p(n),S("solToCfish")):(b(n),S("cfishToSol"))},T=async()=>{if(r==="solToCfish"){if(!t||parseFloat(t)<=0){c({type:"warning",title:s("Invalid Amount"),message:s("Please enter a valid SOL amount to exchange")});return}if(parseFloat(t)>u){c({type:"warning",title:s("Insufficient Balance"),message:s("You do not have enough SOL for this exchange")});return}}else{if(!a||parseFloat(a)<=0){c({type:"warning",title:s("Invalid Amount"),message:s("Please enter a valid CFISH amount to exchange")});return}if(parseFloat(a)>g){c({type:"warning",title:s("Insufficient Balance"),message:s("You do not have enough CFISH for this exchange")});return}}h(!0);try{const o=r==="solToCfish"?"sol-to-cfish":"cfish-to-sol",i=parseFloat(r==="solToCfish"?t:a),n=await fetch(`https://api.example.com/exchange/${o}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({walletAddress:d.toBase58(),amount:i})});if(!n.ok){const j=await n.json();throw new Error(j.message||`HTTP error! status: ${n.status}`)}const y=await n.json();w(y.solBalance),N(y.cfishBalance),c({type:"success",title:s("success"),message:s("Exchange successful!")}),p(""),b("")}catch(o){console.error("Exchange failed:",o),c({type:"error",title:s("error"),message:s("Exchange failed. Please try again.")})}finally{h(!1)}};return m?e.jsx("div",{className:"min-h-screen bg-black text-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-6",children:s("exchange.title")}),f?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(F,{size:"lg"})}):e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:s("exchange.yourSOLBalance")}),e.jsxs("h3",{className:"text-2xl font-bold text-primary-foreground",children:[u.toFixed(6)," SOL"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:s("exchange.yourCFISHBalance")}),e.jsxs("h3",{className:"text-2xl font-bold text-green-400",children:[g.toFixed(6)," CFISH"]})]})]}),e.jsxs("div",{className:"border-t border-border pt-6 mt-6 space-y-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:s("exchange.exchangeRate")}),e.jsxs("p",{className:"text-muted-foreground",children:["1 SOL = ",e.jsxs("span",{className:"font-bold text-primary",children:[x.toFixed(6)," CFISH"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:s("exchange.solAmount")}),e.jsx("input",{type:"number",value:t,onChange:o=>v(o,"sol"),placeholder:"0.00",min:"0",step:"0.000001",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:s("exchange.cfishAmount")}),e.jsx("input",{type:"number",value:a,onChange:o=>v(o,"cfish"),placeholder:"0.00",min:"0",step:"0.000001",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:border-primary"})]}),e.jsx("button",{onClick:T,disabled:f||!t&&!a||r==="solToCfish"&&parseFloat(t)>u||r==="cfishToSol"&&parseFloat(a)>g,className:"w-full px-4 py-2 bg-primary text-black rounded-lg hover:bg-primary/80 transition-colors disabled:opacity-50",children:f?e.jsx(F,{size:"sm"}):s("exchange.performExchange")})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:s("wallet.connectYourWallet")}),e.jsx("p",{className:"text-gray-400 mb-6",children:s("wallet.connectToUseExchange")})]})})};export{k as default};
